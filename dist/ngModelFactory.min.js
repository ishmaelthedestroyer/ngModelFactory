angular.module("Factory",["EventEmitter","Endpoint","Util"]).service("Factory",["$q","Model","Endpoint","EventEmitter","Util",function(a,b,c,d,e){var f=function(a,b){if(!(this instanceof f))return new f(a,b);d.call(this);var c=this,g={endpoints:{perPage:20}};return c.config=e.extend(g,b),c.store={},c.throttle={},c.Model=a,c};return e.inherits(f,d),f.prototype._$dump=function(){var a=this,b=[];for(var c in a.store)b.push(a.store[c]);return b},f.prototype._$wrap=function(a){var b=this;if(b.store[a._id])for(var c in a)b.store[a._id][c]=a[c];else b.store[a._id]=new b.Model(a),b._$registerListeners(b.store[a._id]);return b.store[a._id]},f.prototype._$registerListeners=function(a){var b=this;return a.on("$update",function(c,d){c._id!==d._id&&(delete b.store[a._id],b.store[a._id]=a)}),a.on("$delete",function(a){delete b.store[a._id]}),b},f.prototype.$create=function(a){var b=this,c=new b.Model(a);return c._$isLocal=!0,b.store[c._id]=c,b._$registerListeners(b.store[c._id]),c},f.prototype.$find=function(b,c){var d=this,e=a.defer();return d.Model._$request("find",b,null,null,c).then(function(a){e.resolve(d._$wrap(a))})["catch"](function(a){e.reject(a)}),e.promise},f.prototype.$findSync=function(){},f.prototype.$list=function(b,c,d){var e=this,f=a.defer();return e.Model._$request("list",null,b,c,d).then(function(a){var b=[];angular.forEach(a,function(a){b.push(e._$wrap(a))}),f.resolve(b)})["catch"](function(a){f.reject(a)}),f.promise},f.prototype.$listSync=function(){},f.prototype.$map=function(){},f.prototype.$mapSync=function(){},f}]),angular.module("Model",["EventEmitter","Endpoint","Util"]).service("Model",["$q","Endpoint","EventEmitter","Util",function(a,b,c,d){var e=function(a,b){if(!(this instanceof e))return new e(a,b);c.call(this);var d=this;for(var f in a)d[f]=a[f];return d};return d.inherits(e,c),e._$request=function(a,c,d,f,g){for(var h,i=e._$config.endpoints[a].path;i!==(i=i.replace(":id",c)););return h={method:e._$config.endpoints[a].method,path:i},g&&(h.data=g),new b.Request(h).execute()},e._$init=function(a){var b=this,c={endpoints:{prefix:"",list:{method:"GET",path:"/models"},find:{method:"GET",path:"/models/:id"},create:{method:"POST",path:"/models"},update:{method:"PUT",path:"/models/:id"},del:{method:"DELETE",path:"/models/:id"}}};return e._$config=d.extend(c,a),b},e.prototype.$serialize=function(){var a=this,b={};for(var c in a)b[c]=a[c];return delete b._events,b},e.prototype.$update=function(a){var b=this,c={};for(var d in a)c[d]=angular.copy(b[d]),b[d]=a[d];return b.emit("$update",angular.copy(b),c),b},e.prototype.$save=function(){var a=this,b=({data:a.$serialize()},e._$request(a._$isLocal?"create":"update",a._id,null,null,a.$serialize()));return b.then(function(b){a.$update(b),a._$isLocal&&delete a._$isLocal}),b},e.prototype.$delete=function(){var a=this;a.emit("$delete",a);var b=e._$request("del",a._id);return b.then(function(){})["catch"](function(){}),b},e._$init(null),e}]),angular.module("ngModelFactory",["Factory","Model"]);