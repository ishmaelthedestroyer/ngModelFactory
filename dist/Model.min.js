angular.module("Model",["EventEmitter","Endpoint","Util"]).service("Model",["$q","Endpoint","EventEmitter","Util",function(a,b,c,d){var e=function(a,b){if(!(this instanceof e))return new e(a,b);c.call(this);var d=this;for(var f in a)d[f]=a[f];return d};return d.inherits(e,c),e._$request=function(a,c,d,f,g){for(var h,i=e._$config.endpoints[a].path;i!==(i=i.replace(":id",c)););return h={method:e._$config.endpoints[a].method,path:i},g&&(h.data=g),new b.Request(h).execute()},e._$init=function(a){var b=this,c={endpoints:{prefix:"",list:{method:"GET",path:"/models"},find:{method:"GET",path:"/models/:id"},create:{method:"POST",path:"/models"},update:{method:"PUT",path:"/models/:id"},del:{method:"DEL",path:"/models/:id"}}};return e._$config=d.extend(c,a),b},e.prototype.$serialize=function(){var a=this,b={};for(var c in a)b[c]=a[c];return delete b._events,b},e.prototype.$update=function(a){var b=this,c={};for(var d in a)c[d]=angular.copy(b[d]),b[d]=a[d];return b.emit("$update",angular.copy(b),c),b},e.prototype.$save=function(){var a=this,b={data:a.$serialize()};a._$isLocal?(b.method="POST",b.path="/v1/collections"):(b.method="PUT",b.path="/v1/collections/"+a._id);var c=e._$request(a._$isLocal?"create":"update",a._id,null,null,a.$serialize());return c.then(function(b){a.$update(b),a._$isLocal&&delete a._$isLocal}),c},e.prototype.$delete=function(){var b=a.defer();return b.promise},e._$init(null),e}]);